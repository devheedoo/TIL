클린 소프트웨어

**3부. 설계 원칙**

9장. LSP: 리스코프 치환 원칙

- 정사각형/직사각형 문제
- 잘 정의된 인터페이스와 그 인터페이스의 구현체끼리의 상호 치환 가능성
- 인터페이스를 위배하면 if 문 지옥이 펼쳐진다

10장. ISP: 인터페이스 분리 원칙

- 필요 이상으로 많은 걸 포함하는 모듈에 의존하는 것은 해로운 일이다
- 전혀 관계없는 기능을 수정하기 위해 재배포해야 하는 일이 생겨서는 안 된다

11장. DIP: 의존성 역전 원칙

- 의존성이 추상에만 의존하고, 구현체에는 의존하지 않는 시스템
- 현실적으로 String 과 같이 안정성이 보장된 구체에는 의존해도 괜찮다
- 안정된 소프트웨어 아키텍처란 안정된 추상 인터페이스를 선호하는 아키텍처를 말한다
- 추상 팩토리(Abstract Factory) 패턴으로 의존성을 관리할 수 있다
- 소스 코드 의존성이 제어흐름과 반대 방향으로 역전되므로 의존성 역전이라고 부른다

**4부. 컴포넌트 원칙**

12장. 컴포넌트

- 배포할 수 있는 가장 작은 단위가 컴포넌트다
- 잘 설계된 컴포넌트는 독립적으로 개발 가능한 능력을 갖추고 있어야 한다
- 50년이 지나고 나서야 런타임에 플러그인 형태로 결합할 수 있는 동적 링크 파일을 다룰 수 있게 됐다
- 이 파일이 이 책에서 말하는 소프트웨어 컴포넌트에 해당한다

13장. 컴포넌트 응집도

- REP: 재사용/릴리즈 등가 원칙, Reuse/Release Equivalence Principle

  - 릴리즈 번호가 없다면 재사용 컴포넌트들이 서로 호환되는지 보증할 방법이 전혀 없다
  - 하나의 컴포넌트로 묶인 클래스와 모듈들은 반드시 함께 릴리즈할 수 있어야 한다
  
- CCP: 공통 폐쇄 원칙, Common Closure Principle

  - 동일한 이유로 동일한 시점에 변경되는 클래스를 같은 컴포넌트로 묶어라
  - 코드가 변경되어야 할 일이 있을 때, 최소한의 컴포넌트만 수정되어야 한다
  - 컴포넌트 수준의 SRP다
  
- CRP: 공통 재사용 원칙, Common Reuse Principle

  - 사용하지 않는 클래스를 가진 컴포넌트에 의존해선 안 된다
  - ISP의 포괄적인 버전이다
  
- 균형 다이어그램

  - REP, CCP는 컴포넌트를 더 크게 만들고, CRP는 컴포넌트를 작게 만든다
  - 이 원칙들이 균형을 이루는 방법을 찾아야 한다
  - 개발 단계에 따라 균형도 변할 수 있음을 이해해야 한다
  - 프로젝트의 초점은 개발가능성에서 재사용성으로 바뀌어 간다

14장. 컴포넌트 결합

- ADP: 의존성 비순환 원칙

  - 컴포넌트 의존성 그래프에 순환이 있어서는 안 된다
  - 주 단위 빌드, 의존성 비순환 원칙을 통해 이를 막을 수 있다
  - 비순환 방향 그래프, Directed Acyclic Graph, DAG
  - 의존성 순환이 생길 경우, 의존성 역전 원칙(DIP)을 적용하거나 새 컴포넌트를 만들어 해결할 수 있다
  - 컴포넌트 구조는 하향식으로 설계될 수밖에 없고, 프로젝트 초기에 설계할 수 없다.
  - 컴포넌트 의존성 다이어그램은 애플리케이션의 빌드 가능성과 유지보수성을 보여주는 지도다
  
- SDP: 안정된 의존성 원칙

  - 안정성의 방향으로(더 안정된 쪽에) 의존하라
  - 변경이 쉽지 않은 컴포넌트가 변동이 예상되는 컴포넌트에 의존하게 만들어서는 절대로 안 된다
  - 의존한다/책임진다, 의존적이다/독립적이다
  - Fan-in: 안으로 들어오는 의존성
  - Fan-out: 밖으로 나가는 의존성
  - 불안정성 I = Fo / (Fi + Fo) [0, 1]
  - 의존성 방향으로 갈수록 I 지표 값이 감소해야 한다
  - 인터페이스만을 포함하는 컴포넌트는 다른 컴포넌트가 의존할 수 있는 이상적인 대상이다
  - 루비, 파이썬 같은 동적 타입 언어에서는 추상 컴포넌트가 전혀 존재하지 않는다. 의존성을 역전시킬 때 인터페이스를 선언하거나 상속받는 일이 전혀 필요하지 않기 때문이다.
  
- SAP: 안정된 추상화 원칙

  - 컴포넌트는 안정된 정도만큼만 추상화되어야 한다
  - 안정된 컴포넌트는 추상 컴포넌트여야 하고, 불안정한 컴포넌트는 구체 컴포넌트여야 한다
  - Nc: 컴포넌트의 클래스 개수
  - Na: 컴포넌트의 추상 클래스와 인터페이스의 개수
  - A: 추상화 정도, A = Na / Nc
  - A/I 그래프 상에서 (0, 1) ~ (1, 0)을 잇는 선분을 주계열이라고 부르며 유의미한 구역이다
  - A/I 그래프 상에서 (0, 0) 주변은 고통의 구역, (1, 1) 주변은 쓸모없는 구역이라고 부른다
  
- 좋은 의존성도 있지만 좋지 않은 의존성도 있다



